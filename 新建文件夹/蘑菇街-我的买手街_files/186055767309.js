define("template/pc/www/default/assets/js/nav/module/top-nav",["core/core"],function(t){function e(t,e,a){function i(){var e=o.shift();e&&t.apply(e.context,e.arguments),0===o.length&&(clearInterval(s),s=null)}var o=[],s=null;return function(){o.push({context:a||this,arguments:[].slice.call(arguments)}),s||(i(),s=setInterval(i,e))}}function a(t,e,a){return parseInt(t+"",0|e).toString(0|a)}function i(){var e=$(".J_sitenav .wrap"),a=(l.find(".mgj-my-cart"),l.find(".mgj-my-avatar"),['<a rel="nofollow" href="http://www.mogujie.com" class="home fl">蘑菇街首页</a>','<ul class="header_top">',"{{? it.name}}",'<li class="s1 has_icon user_meta">','<a rel="nofollow" href="javascript:;">',"{{=it.name}}","</a>",'<a rel="nofollow" href="http://www.mogujie.com/member" target="_blank">',"{{?it.userLevel}}",'<span class="level level',"{{=it.userLevel - 1}}",'">&nbsp;</span>',"{{?}}","</a>",'<i class="icon_delta"></i>','<ol class="ext_mode" id="menu_personal">','<li class="s2">','<a target="_blank" rel="nofollow" href="http://www.mogujie.com/settings/personal">个人设置</a>',"</li>",'<li class="s2">','<a target="_blank" rel="nofollow" href="http://www.mogujie.com/settings/bind">账号绑定</a>',"</li>",'<li class="s2">','<a rel="nofollow" href="//www.mogujie.com/logout">退出</a>',"</li>","</ol>","</li>",'<li class="s1 has_line message_center">','<a rel="nofollow" href="javascript:;" class="ext_module mogutalk_btn J_msg open_msg micon __trace__" data-from="shopwidget_message" data-trace="global,shopwidget_message,click">','消息<span class="num m_num"></span>',"</a>","</li>",'<li class="s1 has_icon has_line user_fav">','<a rel="nofollow" href="javascript:;">我的收藏</a>','<i class="icon_delta"></i>','<ul class="ext_mode">','<li class="s2">','<a target="_blank" rel="nofollow" href="http://www.mogujie.com/active/favs">收藏的商品</a>',"</li>",'<li class="s2">','<a target="_blank" rel="nofollow" href="http://www.mogujie.com/active/shopfavs">收藏的小店</a>',"</li>",'<li class="s2">','<a target="_blank" rel="nofollow" href="http://www.mogujie.com/active/browserlog">浏览足迹</a>',"</li>","</ul>","</li>","{{??}}",'<li class="s1 show-nologin">','<a rel="nofollow" href="http://www.mogujie.com/register/">注册</a>',"</li>",'<li class="s1 show-nologin">','<a rel="nofollow" href="http://www.mogujie.com/login/">登录</a>',"</li>","{{?}}",'<li class="s1 myorder has_line">','<a href="http://order.mogujie.com/order/list4buyer" target="_blank" class="text display_u" ref="nofollow">我的订单</a>',"</li>",'<li class="s1 has_line shopping_cart_v2">','<a class="cart_info_wrap" href="http://cart.mogujie.com/cart/mycart?traceid=" target="_blank" ref="nofollow">','<span class="cart_info">购物车</span>',"</a>",'<i class="icon_delta"></i>','<span class="shopping_cart_loading"></span>',"</li>",'<li class="s1 has_line has_icon custom_item">','<a rel="nofollow" href="http://www.mogujie.com/service" ref="nofollow" target="_blank">客户服务</a>','<i class="icon_delta"></i>','<ol class="ext_mode">','<li class="s2"><a target="_blank" rel="nofollow" href="http://www.mogujie.com/help">消费者服务</a></li>','<li class="s2"><a target="_blank" rel="nofollow" href="http://www.xiaodian.com/pc/shopadmin/help/home">商家服务</a></li>','<li class="s2"><a target="_blank" rel="nofollow" href="http://www.mogujie.com/rule/index">规则中心</a></li>',"</ol>","</li>",'<li class="s1 has_line has_icon myxiaodian">','<a href="http://www.xiaodian.com" ref="nofollow" target="_blank" class="text display_u">我的小店</a>','<i class="icon_delta"></i>','<ol class="ext_mode">','<li class="s2"><a target="_blank" rel="nofollow" href="http://www.xiaodian.com/pc/shopadmin/shopface">管理后台</a></li>','<li class="s2"><a target="_blank" rel="nofollow" href="http://bbs.xiaodian.com">商家社区</a></li>','<li class="s2"><a target="_blank" rel="nofollow" href="http://peixun.xiaodian.com">商家培训</a></li>','<li class="s2"><a target="_blank" rel="nofollow" href="http://www.xiaodian.com/pc/joinmarket">市场入驻</a></li>',"</ol>","</li>","</ul>"].join(""));t.fn.getUserData&&t.fn.getUserData(function(i,o){i||(e.html(t.ui.getTemplate(a,o)),$("body").trigger("userdatarecieve",[o]),window.newcinfo&&window.newcinfo.refresh())})}function o(t){$("#header .header_top"),$(".mgj_rightbar .mgj-my-cart"),$(".mgj_rightbar .mgj-my-avatar");t.uname&&t.uname.length>0&&t.shopFaved&&$(".J-shop-follow").addClass("shop-followed").html("已收藏"),t.jumpUrl&&t.jumpUrl.length>0&&(location.href=t.jumpUrl)}function s(){function t(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),a=window.location.search.substr(1).match(e);return null!=a?unescape(a[2]):null}function e(t,e){var a=new Date;a.setTime(a.getTime()+31536e6),document.cookie=t+"="+escape(e)+";expires="+a.toGMTString()}function a(t){var e,a=new RegExp("(^| )"+t+"=([^;]*)(;|$)");return(e=document.cookie.match(a))?unescape(e[2]):null}var i=$("#menu_personal"),o=$(".dapei_tip",i),s=$(".dapei_btn",i);s.click(function(){e("dapei_tip_hidden",!0),o.hide(),setTimeout(function(){i.mouseleave(function(){$(this).removeClass("ext_mode_show")})},1e3)}),null!=t("isDaPeiShi")?i.addClass("ext_mode_show"):"true"==$("#isDaPeiShi").val()&&null==a("dapei_tip_hidden")&&i.addClass("ext_mode_show")}var t=t||window.MoGu||{};t.fn=t.fn||{},t.fn.greyTest=function(t,e){$.ajax({url:"http://www.mogujie.com/trade/abtest/service/getBucket",data:{biz:t},dataType:"jsonp",type:"get",success:function(t){$.isFunction(e)&&e(null,t)},fail:function(t){$.isFunction(e)&&e(t)}})},t.fn.refreshToken=function(t){$.ajax({url:"/csrf/token/get",dataType:"json",type:"get",success:function(e){e.status&&1001==e.status.code&&(window.__token=e.result.token,$.isFunction(t)&&t(null,e))},fail:function(e){$.isFunction(t)&&t(e)}})},t.fn.getUserData=e(function(e){if(t.data=t.data||{},t.data.userData)$.isFunction(e)&&e(null,t.data.userData);else{var a=location.protocol||"http:";$.ajax({url:a+"//portal.mogujie.com/api/profile/baseinfo",dataType:"jsonp",type:"get",success:function(a){if(1001==a.status.code){var i=a.result;t.data.userData=i,$.isFunction(e)&&e(null,i)}else{var i={};t.data.userData=i,$.isFunction(e)&&e(null,i)}},fail:function(t){$.isFunction(e)&&e(t)}})}},100),t.fn.id2url=function(t,e){var i="",o=e||1;if(t=""+t,24==t.length)return t;switch(o){case 1:i=o+a(2*t+56,10,36);break;default:i=!1}return i};var n=$(".header_2015"),l=$(".mgj_rightbar");i(),window.ESIMOGUPROFILE&&o(MOGUPROFILE),s();var r=(t.ui.getdoT(),{});r.Tpl={headerMsgTpl:[]},r.View={init:function(){this.addEvent()},addEvent:function(){var t=this;$("body").on("cinfodatarecieve",function(e,a){if(a){var i=a,o={};o.twitterNew=parseInt(i.cmessageNew),o.catmeNew=parseInt(i.a),o.cfavedNew=parseInt(i.b),o.cmsgNew=parseInt(i.c),o.fansNew=parseInt(i.d),o.csysmsgNew=parseInt(i.e),o.cactiveNew=parseInt(i.f),o.intelligent=parseInt(i.g),o.ccartNew=parseInt(i.h),o.chatNew=parseInt(i.i),o.ccouponShop=parseInt(i.q),o.ccouponPlatform=parseInt(i.j),$.each(t.renders,function(t,e){$.isFunction(e)&&e(o)})}}),$(document).on("hasUnread",function(t,e){var a=n.find(".mogutalk_btn");a.length&&(e>0?a.find(".num").show():a.find(".num").hide())})},renders:{renderNavCart:function(t){var e=n.find(".shopping_cart_v2");if(e.length)if(t.ccartNew>0){var a=t.ccartNew>99?"99+":t.ccartNew,i='<span class="cart_info">购物车<b class="num">'+a+"</b>件</span>";e.find(".cart_info_wrap").html(i).show()}else e.find(".cart_info_wrap").html('<span class="cart_info">购物车</span>')},renderSideBarCart:function(t){var e=l.find(".mgj-my-cart");e.length&&(t.ccartNew>0?e.find(".num").html(t.ccartNew>99?"99+":t.ccartNew).show():e.find(".num").hide())},renderSideBarCoupon:function(t){var e=l.find(".mgj-my-coupon");if(e.length){var a=parseInt(t.ccouponShop+t.ccouponPlatform,10);a?e.find(".num").html(a>99?"99+":a).show():e.find(".num").hide()}},renderNavMsg:function(t){}}},r.View.init();var c=function(){this.highClassName="s1_on"};c.prototype={add2Collection:function(t){$.browser.msie&&6==$.browser.version&&$.isPlainObject(t)&&t.wrap.length&&t.target&&this._registerEvent(t)},_registerEvent:function(t){var e=this;t.wrap.on("mouseenter",t.target,function(t){$(this).addClass(e.highClassName).siblings().removeClass(e.highClassName)}),t.wrap.on("mouseleave",t.target,function(t){$(this).removeClass(e.highClassName)})}},(new c).add2Collection({wrap:$(".header_top"),target:".s1"})}),define("text",{load:function(t){throw new Error("Dynamic load not allowed: "+t)}}),define("text!template/pc/www/default/assets/tpl/sidebar.tpl",[],function(){return'<!--空的右侧边栏-->\n<div id="mgj_rightbar_top_blank" class="mgj_rightbar_960"></div>\n<!--方便定margin的空dediv-->\n<div id="mgj_rightbar_blank_div"></div>\n<!--用户头像-->\n<div class="sidebar-item mgj-my-avatar"></div>\n<!--购物车-->\n<div class="sidebar-item mgj-my-cart">\n    <a target="_blank" href="http://www.mogujie.com/trade/cart/mycart" rel="nofollow">\n        <i class="s-icon"></i>\n        <div class="s-txt">购物车</div>\n        <div class="num"></div>\n    </a>\n</div>\n<!--优惠券-->\n<div class="sidebar-item mgj-my-coupon">\n    <a target="_blank" rel="nofollow" href="http://www.mogujie.com/trade/promotion/user/shopcoupon">\n        <i class="s-icon"></i>\n        <div class="s-txt">优惠券</div>\n        <div class="num"></div>\n    </a>\n</div>\n<!--钱包-->\n<div class="sidebar-item mgj-my-wallet">\n    <a target="_blank" rel="nofollow" href="https://f.mogujie.com/wallet/home/">\n        <i class="s-icon"></i>\n        <div class="s-txt">钱包</div>\n    </a>\n</div>\n<!--足迹-->\n<div class="sidebar-item mgj-my-browserlog">\n    <a target="_blank" rel="nofollow" href="http://www.mogujie.com/active/browserlog">\n        <i class="s-icon"></i>\n        <div class="s-txt">足迹</div>\n    </a>\n</div>\n<div class="sideBottom">\n    <!--回到顶部-->\n    <div class="sidebar-item mgj-back2top"><a rel="nofollow" href="javascript:;"><i class="s-icon"></i></a></div>\n</div>\n'}),define("template/pc/www/default/assets/js/nav/module/nav-sidebar",["text!template/pc/www/default/assets/tpl/sidebar.tpl"],function(t){var e=1260,a=$(".mgj_rightbar"),i=MoGu.ui.getTemplate(t);a.html(i);var o={goTop:a.find(".mgj-back2top"),sidebar:a,sidebarCart:a.find(".mgj-my-cart"),init:function(){return"Microsoft Internet Explorer"==navigator.appName&&"MSIE6.0"==navigator.appVersion.split(";")[1].replace(/[ ]/g,"")?void $(".mgj_rightbar").hide():(this.sidebar.show(),void(this.goTop.length&&(this.offsetEl=$(".wrap").length?$(".wrap").eq(0):$("#body_wrap"),this.offsetEl.length&&(this.win=$(window),this.setSidebarPos(),this.addEvent()))))},addEvent:function(){var t=this;this.win.on("resize",function(e){t.setSidebarPos()});var a=['<a target="_blank" href="http://www.mogujie.com/member/" rel="nofollow">','<div class="img">','<img width="20" height="20" src="{{=it.avatar}}_48x48.jpg" alt="">',"</div>","</a>"].join("");$("body").on("userdatarecieve",function(t,e){e.avatar&&$(".mgj_rightbar .mgj-my-avatar").html(MoGu.ui.getTemplate(a,e))}),this.sidebarCart.off().on("mouseenter",function(){t.win.width()>e||t.showSidebar()}),this.sidebar.off().on("mouseleave",function(){t.win.width()>e||t.hideSidebar()}),this.win.on("scroll",function(e){$(this).scrollTop()?t.goTop.addClass("show"):t.goTop.removeClass("show")}),this.goTop.on("click",function(e){return t.win.scrollTop(0),!1})},setSidebarPos:function(){var t=(this.offsetEl.offset(),this.offsetEl.outerWidth(),this.win.width());e>t?this.hideSidebar():this.showSidebar()},showSidebar:function(){this.sidebarCart.stop().animate({left:"0"}),this.goTop.stop().animate({left:"0"}),this.sidebar.removeClass("mini").stop().animate({right:"0"})},hideSidebar:function(){this.sidebarCart.stop().animate({left:"-30px"}),this.goTop.stop().animate({left:"-30px"}),this.sidebar.addClass("mini").stop().animate({right:"-30px"})}};o.init()}),define("template/pc/www/default/assets/js/nav/module/cart",[],function(){var t={},e=['<div class="shop_cart_info" style="display: none;">','<ul class="max_height_ie6">',"{{~ it.list:item:index}}","{{?index < it.topNum}}","<li>",'<a rel="nofollow" href="http://shop.mogujie.com/detail/{{=item.itemIdEsc}}" target="_blank" class="imgbox">',"{{?item.imgUrl}}",'<img src="{{=item.imgUrl}}" alt="{{=item.title}}" width="45">',"{{?}}","</a>",'<a rel="nofollow"  href="http://shop.mogujie.com/detail/{{=item.itemIdEsc}}" target="_blank" class="title">{{=item.title}}</a>',"{{?item.skuAttributes}}",'<span class="info">{{~ item.skuAttributes:sku:key }}{{=sku.key}}: {{=sku.value}}  {{~}}</span>',"{{?}}",'<span class="price">¥{{=(item.nowprice/100)}}</span>','<span data-stockid="{{=item.stockIdEsc}}" class="del">删除</span>',"</li>","{{?}}","{{~}}","</ul>",'<div class="subbox">',"{{?it.total-it.topNum>0}}",'<p class="sub_info">购物车里还有<b class="num">{{=it.total - it.topNum}}</b>件商品</p>',"{{?}}",'<div class="fr">','<a rel="nofollow" href="http://cart.mogujie.com/cart/mycart" target="_blank" class="goel">查看购物车</a>',"</div>","</div>","</div>"].join("");t.Model={goodsList:"",offlineCartCookies:"",offlineCartCookiesOld:"",goodsNum:0,getGoodsList:function(t){var e=this;if(e.goodsList)return void($.isFunction(t)&&t(this.goodsList));var a=[];if(MoGu.util.getCookie("trade_cart_mogujie")?e.offlineCartCookies=MoGu.util.getCookie("trade_cart_mogujie"):MoGu.util.getCookie("mogu_trade_cart")&&(e.offlineCartCookiesOld=MoGu.util.getCookie("mogu_trade_cart")),e.offlineCartCookies){var i=JSON.parse(e.offlineCartCookies);for(var o in i){var s={};s.stockId=o;for(var n in i[o])s[n]=i[o][n];a.push(s)}}if(e.offlineCartCookiesOld)for(var i=e.offlineCartCookiesOld.split(","),s={},n=0;n<i.length;n++)if(i[n].indexOf("#")>-1){var l=i[n].split("#");s.number=l[0],s.lastAddCartTime=l[1],a.push(s),s={}}else s.stockId=MoGu.fn.id2url(i[n]);var r={topNum:e.maxShowNum,marketType:"market_mogujie",offlineCartItems:JSON.stringify(a)};MoGu.fn.refreshToken(function(a,i){if(!a){var o=location.protocol||"http:";r.token=window.__token,$.ajax({url:o+"//cart.mogujie.com/api/cart/miniCartList",data:r,dataType:"jsonp",type:"get",success:function(a){1001==a.status.code?(e.goodsList=a.result.cartItems?a.result.cartItems:[],e.goodsNum=a.result.totalItemNum||0,$.isFunction(t)&&t(e.goodsList)):$.isFunction(t)&&t([])}})}})},delCookie:function(t,e){var a={};if(this.offlineCartCookies){var i=JSON.parse(this.offlineCartCookies);for(var o in i)o!=t&&(a[o]=i[o]);MoGu.util.setCookie("trade_cart_mogujie",JSON.stringify(a),{expires:15,path:"/",domain:".mogujie.com"})}},delGood:function(t,e){var a=this;$.post("/api/cart/deleteCart",{marketType:"market_mogujie",stockId:t},function(i){if(1001==i.status.code){var o=i.status.isLogin;o||a.delCookie(t),$.isFunction(e)&&e()}else alert(i.status.msg)},"json")}},t.View={wrap:$(".header_2015"),init:function(){this.wrap.length&&(this.extendInfo=null,this.loading=this.wrap.find(".shopping_cart_loading"),this.maxShowNum=5,this.addEvent())},addEvent:function(){var a=this;this.wrap.find(".cart_info_wrap").attr("href","http://cart.mogujie.com/cart/mycart"),$(".mgj_rightbar .mgj-my-cart a").attr("href","http://cart.mogujie.com/cart/mycart"),a.wrap.off("mouseenter").on("mouseenter",".shopping_cart_v2",function(i){var o=$(this);o.addClass("sc_on"),a.loading.show(),a.extendInfo&&a.extendInfo.length?(a.loading.hide(),a.extendInfo.show()):t.Model.getGoodsList(function(i){var s={list:i,topNum:a.maxShowNum,total:t.Model.goodsNum};if(i.length){var n=MoGu.ui.getTemplate(e,s);a.extendInfo=$(n)}else{var n='<div class="shop_cart_info"></div>';a.extendInfo=$(n),a.extendInfo.addClass("empty_cart").text("购物车里没有商品！")}o.append(a.extendInfo),a.loading.hide(),a.extendInfo.show()})}),a.wrap.off("mouseleave").on("mouseleave",".shopping_cart_v2",function(t){a.extendInfo&&a.extendInfo.hide()&&$(this).removeClass("sc_on")}),a.wrap.off("click").on("click",".shopping_cart_v2 .del",function(){var e=$(this),i=e.data("stockid"),o=(a.wrap.find(".num"),e.parent()),s=t.Model.goodsNum;e.hasClass("disabled")||(e.addClass("disabled"),t.Model.delGood(i,function(){s--,o.fadeOut("slow",function(){e.removeClass("disabled"),s?(o.remove(),t.Model.goodsNum=s):(a.extendInfo=$(".shop_cart_info"),a.extendInfo.addClass("empty_cart").text("购物车里没有商品！"))})}))})}},t.View.init()}),define("template/pc/www/default/assets/js/nav/module/back2top",[],function(){var t={wrap:$(".back2top_wrap"),init:function(){this.wrap.length&&(this.offsetEl=$(".wrap").length?$(".wrap").eq(0):$("#body"),this.offsetEl.length&&(this.win=$(window),this.goTop=this.wrap.find(".go_top"),this.setPos(),this.wrap.show(),this.addEvent()))},addEvent:function(){var t=this;this.win.on("resize",function(e){t.setPos()}),this.win.on("scroll",function(e){$(this).scrollTop()?t.goTop.addClass("show"):t.goTop.removeClass("show")}),this.goTop.on("click",function(e){return t.win.scrollTop(0),!1})},setPos:function(){var t=this.offsetEl.offset(),e=this.offsetEl.outerWidth(),a=this.win.width(),i=this.wrap.width(),o=15,s=t.left+e+20;i+s+o>a?this.wrap.css({left:"auto",right:o}):this.wrap.css({left:s,right:"auto"})}};t.init()}),require(["template/pc/www/default/assets/js/nav/module/top-nav","template/pc/www/default/assets/js/nav/module/nav-sidebar","template/pc/www/default/assets/js/nav/module/cart","template/pc/www/default/assets/js/nav/module/back2top"],function(){});